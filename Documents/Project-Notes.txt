
======================================
2D Survival Game Notes
======================================

Source:
https://www.udemy.com/course/unreal-engine-5-create-a-top-down-2d-survivors-style-game

=====================================================================
Section 2: Basic Setup

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
3. Create Project and Player Flipbooks

Importing Textures:

* Eliminate Blurriness:
  * Open Texture -> Details -> Advanced -> Filter -> Nearest

* Other Textuire Settings:
  * Right-click -> Sprite Actions -> Apply Paper2D Texture Settings
    * This makes the background transparent

Extract Sprites from Texture:
* Reason: You cannot drag a Texture into a scene, but you can with a Sprite
* Right-click->Sprite Actions->Extract Sprites
* This opens the Extract Sprites Dialog:
  * Change Sprite Extract Mode from Auto to Grid:
    * Auto will produce uneven sprites
  * You then manually edit the Sprites using Cell Width and Cell Height
    * This will be dependent upon the source sprite
  * Click the Extract button and Sprite assets will then be generated in the project

Create Flipbooks (animations) from the Sprites:
* Right-click the Sprites you want in a Flipbook -> Create Flipbook
  * NOTE:
   * Using Asesprite and importing png's and json files makes the Flipbook process easier
     * The extracted sprites can be named for easier selection

Bulk Edit:
* Select multiple Flipbooks -> Right-click -> Asset Actions-> Edit Selection in Property Matrix


++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
4. TileMap and Scaling

Source Tileset:
https://0x72.itch.io/dungeontileset-ii
* 0x72_DungeonTilesetII_v1.7.png

Importing the Texture:
* Right-click->Sprite Actions->Apply Paper2D Texture Settings
* Open asset -> Details -> Filter -> Nearest

Creating the Tileset:
* Right-click asset -> Sprite Actions -> Create Tile Set

Tileset Grid Settings:
* Open Tileset -> Tile Size:
  * 161x16 for this asset

Create a TileMap from the Tile
* Right-click the TileSet -> Create Tile Map

Tile Map:
* Create levels with this object
* Can have multiple layers
* Change size of Map using Details -> Setup -> Map Width / Map Height
* Once a TileMap is created, it can be dragged into the level scene

Note:
* In this project, it seems to be set up as X-right, Y-down (Top Left Corner)
* Location of TileMap in scene set to (-500,-500,5)
  * The height of 5 was supposedly for handling capsule collisions


++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
5. Create Player Character

Base Class: Character
Components:
* Paper Flipbook

Paper Flipbook:
* Source Flipbook: Set the player sprite flipbook
* Rotation:
  * This project rotated the PaperFlipbook to -90 around X
  * This basically has the player sprite facing upwards (down +Z axis)
  * This also means the player character will be moving in the XY Plane 2D space

Capsule Component:
* Adjusted to fit the player character sprite
  * Capsule Half Height: 14
  * Capsule Radius: 14
* Collision Presets:
  * Changed from Pawn to Custom
    * Collision Responses: Ignore (sets all to Ignore)
    * Object Responses->WorldStatic:  Block
    * Object Responses->Pawn:  Overlap

Camera:
* Spring Arm Component + Camera (child)
* SpringArm Settings:
  * Rotation: (-90, -90, 0)
    * This rotates around the Y axis so it is facing down at the player flipbook
    * This rotates around the X axis so it "twists" so it is aligned properly
  * Target Arm Length: 1300
    * With an Orthographic camera, the distance will have no effect on the camera
    * This is just to get some distance between the player sprite and the camera
  * Camera Collision -> Do Collision Test:  FALSE
    * This ensures the camera doesn't collide with any obstacles / objects
  * Lag -> Enable Camera Lag:  TRUE
  * Lag -> Camera Lag Speed:  6.0
* Camera Settings:
  * Projection Mode: Orthographic
  * Ortho Width: 512
    * Note: My Ortho Width was automatically set to 1536, while his was 512

Game Mode:
* GM_InGame
* Default Pawn Class: BP_Player

Testing:
* Camera too close
* Player character too bright

Fixes:
* FollowCamera:
  * Change Ortho Width to 700
* PaperFlipbook:
  * Sprite -> Sprite Color: Changed from White to a Gray
    * Note: There are no lights in the scene
    * Supposedly, Sprites are still affected by their default color
    * TODO: Investigate a better solution
      * I've written a local document about this (Unreal Sprite Settings.txt)

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
6. Setup Enhanced Inputs

Steps:
* Create InputActions
* Create Input Mapping Context
* Set Mapping Context on the player controller


Inputs:
WASD:

D
* Right
* Modifiers: None

A:
* Left
* Modifiers:
  * Negate => X: true, Y: false, Z: false (only negates X)

S:
* Down
* Modifiers:
  * Swizzle Input Axis Values => Order: YXZ (default, interprets input as Y input)

W:
* Up
* Modifiers:
  * Swizzle Input Axis Values => Order: YXZ (default, interprets input as Y input)
  * Negate => X: false, Y: true, Z: false (only negates Y)


NOTE:
* Notice that he has Negate on W / Up. This is because of the way he set up the game, where +Y is down. This top-down game where the view is looking down -Z. +X is right, +Y is down. This is equivalent to the "Top" Orthographic view. Personally, I think I would have chosen the "Right" view, where +Z is up, +X is right (i.e. the XZ plane is the 2D game space)

---------------------------------------------------------------
Handling the Events

* In the player Blueprint (e.g. BP_Player), in the Event Graph, right-click, start typing one of your Input Actions to handle the Enhanced Input Action Event (e.g. IA_Movement)

* Since the Value Type in IA_Movement was set to Axis2D (Vector2D), the "Action Value" will be a Vector2D. Drag and select Break Vector 2D (or Right-click and "Break" the pin) to split it into X and Y values. Note: I prefer to drag and break as it keeps the Event Node cleaner.

---------------------------------------------------------------
Input Action:
* Triggered: Player is holding button
* Started:   Player just pressed the button
* Completed: Player just released the button

---------------------------------------------------------------
Applying Movement to the Player Character

In the player Blueprint (BP_Player, which is a Character subclass)

Handling the IA_Movement Enhanced Input Action Event in the Blueprint Event Graph

Horizontal Direction
* Node: AddMovementInput (inherited from Pawn)
* We set "World Direction" to (1.0, 0.0, 0.0) 
  * This is the X-direction
  * We passed in ActionValX (from the input) into Scale Value

Vertical Direction
* Node: AddMovementInput (inherited from Pawn)
* We set "World Direction" to (0.0, 1.0, 0.0)
  * This is the Y-direction
  * We passed in ActionValY (from the input) into Scale Value


Character Movement Component:
* There are many values here we can tweak, but only will focus on a few.
* Character Movement: Walking
  * Max Walk Speed: Changed from 600cm/s to 100cm/s



++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

=====================================================================
